<!DOCTYPE html>
<html>

	<head>
		<title>消息</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="no">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="renderer" content="webkit">
		<meta name="screen-orientation" content="portrait">
		<meta name="full-screen" content="yes">
		<meta name="x5-orientation" content="portrait">
		<meta name="x5-fullscreen" content="true">
		<meta name="format-detection" content="telephone=no, email=no">

		<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js"></script>
		<script type="text/javascript" src="static/lib/js/vue.min.js"></script>
		<script type="text/javascript" src="static/lib/js/ydui.js"></script>
		<link rel="stylesheet" href="css/mkui.css" />
		<link rel="stylesheet" href="static/lib/css/ydui.rem.css" />
		<link rel="stylesheet" href="static/css/common.css" />

		<link rel="stylesheet" href="css/aui.css" />
		<script type="text/javascript" src="js/aui-tab.js"></script>
		<script type="text/javascript" src="js/aui-dialog.js"></script>

		<style>
			.msg-right p span:nth-child(2) {
				font-family: NotoSansHans-Regular;
				font-size: 0.7rem;
				color: #cccccc;
			}
			
			.msg-right p span:nth-child(3) {
				font-family: NotoSansHans-Regular;
				font-size: 0.7rem;
				color: #717171;
				margin-right: 10px;
			}
			
			.msg-news {
				text-overflow: ellipsis;
				white-space: nowrap;
			}
		</style>
	</head>

	<body>
		<div id="app" hidden>
			<section v-if="msg_empty">
				<div class="fail">
					<div class="fail-pic">
						<img src="static/img/fabu-fail.png" alt="" />
					</div>
					<p>现在还没有收到消息哦</p>
				</div>
			</section>
			<section v-for="item in systemMessage" class="mesg overflow-h border-b">
				<div class="pic">
					<a href=""><img src="static/img/Group@2x.png" /></a>
				</div>
				<div class="msg-right">
					<p class="overflow-h">
						<span class="fl" onclick="detail(1)">系统通知</span>
						<span class="fr mr-8" onclick="deleteMessage(this)">删除</span>
						<span class="fr">{{item.created_at}}</span>
					</p>
					<p class="msg-news" onclick="detail(1)">
						{{item.content}}
					</p>
				</div>
			</section>
			<section v-for="item in chatMessage" class="mesg overflow-h border-b">
				<div class="pic pos-r">
					<a href=""><img :src="item.avatar" /></a>
					<i v-if="item.read==0" class="red"></i>
				</div>
				<div class="msg-right">
					<p class="overflow-h">
						<span class="fl" @click="chat(item.from_uid)">{{item.nickname}}</span>
						<span class="fr mr-8" onclick="deleteMessage(this)">删除</span>
						<span class="fr">{{item.created_at}}</span>
					</p>
					<p class="msg-news" @click="chat(item.from_uid)">
						{{item.content}}
					</p>
				</div>
			</section>
		</div>
		<div style="height: 2.55rem;"></div>
		<footer class="aui-bar aui-bar-tab" id="footer">
			<div class="aui-bar-tab-item" tapmode>
				<i class="aui-iconfont aui-icon-home"></i>
				<div class="aui-bar-tab-label">首页</div>
			</div>
			<div class="aui-bar-tab-item" tapmode>
				<i class="aui-iconfont aui-icon-edit"></i>
				<div class="aui-bar-tab-label">发布</div>
			</div>
			<div class="aui-bar-tab-item" tapmode>
				<div id="xiaoxi_tip" class="aui-badge"></div>
				<i class="aui-iconfont aui-icon-comment"></i>
				<div class="aui-bar-tab-label">消息</div>
			</div>
			<div class="aui-bar-tab-item" tapmode>
				<i class="aui-iconfont aui-icon-my"></i>
				<div class="aui-bar-tab-label">我的</div>
		</footer>
	</body>

	<script type="text/javascript">
		new Vue({
			el: '#app',
			data: {
				msg_empty: false,
				systemMessage: [{}],
				chatMessage: [{
					avatar: 'static/img/touxiang.png',
					read: 0,
					nickname: '王爷',
					content: 'ad看风景阿卡丽附近开了多少放声大哭减肥开始',
					from_uid: '1122',
				}]
			},
			mounted: function() {
				$("#app").show();
			}
		})

		$(function() {
			$('#xiaoxi_tip').hide();
		})

		function detail(id) {
			window.location.href = "message/msg_detail.html?id=" + id;
		}

		function deleteMessage(obj) {
			if(confirm("确定要删除吗?")) {
				$(obj).parent().parent().parent().remove();
			}
		}

		function chat(id) {
			window.location.href = "message/chat_detail.html?id=" + id;
		}

		var tab = new auiTab({
				element: document.getElementById("footer"),
				index: 3
			},
			function(ret) {
				switch(ret.index) {
					case 1:
						window.location.replace("home.html")
						break;
					case 2:
						window.location.replace("fabu.html")
						break;
					case 3:
						break;
					case 4:
						window.location.replace("wode.html")
						break;
				}
			});
	</script>

</html>